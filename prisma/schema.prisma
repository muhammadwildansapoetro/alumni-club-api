generator client {
  provider      = "prisma-client-js"
  output        = "../generated/prisma"
  binaryTargets = ["native", "darwin-arm64", "windows"]
}

datasource db {
  provider = "postgresql"
}

model User {
  id                       String     @id @default(cuid())
  email                    String     @unique
  name                     String?
  password                 String? // For email/password authentication
  googleId                 String?    @unique // For Google OAuth
  authMethod               AuthMethod @default(EMAIL)
  role                     UserRole   @default(USER)
  emailVerified            Boolean    @default(false)
  emailVerificationToken   String?    @unique
  emailVerificationExpires DateTime?
  passwordResetToken       String?    @unique
  passwordResetExpires     DateTime?
  deletedAt                DateTime?
  createdAt                DateTime   @default(now())
  updatedAt                DateTime   @updatedAt
  profile                  Alumni?
  businessListings         Business[]
  jobPostings              Jobs[]
}

model Alumni {
  id              String           @id @default(cuid())
  userId          String           @unique
  npm             String
  fullName        String
  department         Department
  classYear          Int
  graduationYear     Int?
  highestEducation   HighestEducation?
  cityId             Int?
  cityName        String?
  provinceId      Int?
  provinceName    String?
  countryId       Int?
  countryName     String?
  industry        IndustryField?
  jobLevel        JobLevel?
  employmentType  EmploymentType?
  incomeRange     IncomeRange?
  jobTitle        String?
  companyName     String?
  linkedInUrl     String?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  user            User             @relation(fields: [userId], references: [id])
  city            City?            @relation(fields: [cityId], references: [id])
  province        Province?        @relation(fields: [provinceId], references: [id])
}

model Jobs {
  id          String   @id @default(cuid())
  userId      String
  title       String
  description String
  company     String?
  location    String?
  jobType     String?
  salaryRange String?
  externalUrl String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  user        User     @relation(fields: [userId], references: [id])
}

model Business {
  id           String   @id @default(cuid())
  userId       String
  businessName String
  description  String
  category     String?
  location     String?
  website      String?
  contactInfo  String?
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  user         User     @relation(fields: [userId], references: [id])
}

model Province {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  code      String?  @unique
  cities    City[]
  alumni    Alumni[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model City {
  id         Int      @id @default(autoincrement())
  name       String
  provinceId Int
  code       String?
  alumni     Alumni[]
  province   Province @relation(fields: [provinceId], references: [id])
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@unique([name, provinceId])
}

model Statistics {
  id           String         @id @default(cuid())
  type         StatisticsType @unique
  alumniData   Json?
  jobsData     Json? // Updated from jobData
  businessData Json?
  totalItems   Int            @default(0)
  lastUpdated  DateTime       @default(now())
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
}

enum UserRole {
  USER
  ADMIN
}

enum AuthMethod {
  EMAIL
  GOOGLE
}

enum Department {
  TEP
  TPN
  TIN
}

enum JobLevel {
  INTERN
  STAFF
  SUPERVISOR
  MANAGER
  SENIOR_MANAGER
  DIRECTOR
  VP
  C_LEVEL
  FOUNDER
  OTHER
}

enum EmploymentType {
  FULL_TIME
  PART_TIME
  SELF_EMPLOYED
  FREELANCE
  CONTRACT
  INTERNSHIP
  SEASONAL
  APPRENTICESHIP
}

enum IncomeRange {
  BELOW_5M
  RANGE_5_10M
  RANGE_10_15M
  ABOVE_15M
  UNKNOWN
}

enum IndustryField {
  AGRICULTURE
  FOOD_TECH
  BIOTECH
  RESEARCH
  EDUCATION
  ENGINEERING
  BUSINESS
  MARKETING
  FINANCE
  GOVERNMENT
  OTHER
  HORTICULTURE
  PLANTATION
  LIVESTOCK
  FISHERIES
  FOOD_PROCESSING
  AGRI_CHEMICAL
  AGRI_MACHINERY
  IRRIGATION
  MANUFACTURING
  CONSTRUCTION
  MINING
  ENERGY
  TELECOMMUNICATION
  TRANSPORTATION
  LOGISTICS
  HEALTHCARE
  HOSPITALITY
  RETAIL
  REAL_ESTATE
  CONSULTING
  LEGAL
  MEDIA
  ENTERTAINMENT
  INFORMATION_TECHNOLOGY
  E_COMMERCE
  BANKING
  INSURANCE
}

enum StatisticsType {
  ALUMNI
  JOBS
  BUSINESS
}

enum HighestEducation {
  MASTER
  DOCTOR
}
